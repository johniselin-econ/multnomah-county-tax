--------------------------------------------------------------------
      name:  log_02
       log:  C:/Users/ji252/Documents/GitHub/multnomah-county-tax/co
> de/logs/02_log_sdid_2026-01-10.log
  log type:  text
 opened on:  11 Jan 2026, 12:09:51

. 
. ** Parameters 
. local reps = 100

. 
. ** Load data 
. use "${data}working/irs_county_gross", replace 

. 
. ** Keep required variables 
. keep year fips state* county* *_net_3 *_out_1 *_out_2 *_in_3 *_out
> _3

. order year fips state* county* 

. 
. ** Merge with ACS Data 
. merge 1:1 year fips using "${data}working/acs_county_gross_18plus"
> , gen(merge_acs_1)
(variable fips was float, now double to accommodate using data's
       values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                        20,771
        from master                    18,963  (merge_acs_1==1)
        from using                      1,808  (merge_acs_1==2)

    Matched                             3,017  (merge_acs_1==3)
    -----------------------------------------

. 
. ** Keep require variables 
. keep year fips state* county* *_net_3 *_out_1 *_out_2 *_in_3 *_out
> _3 merge_acs_*

. 
. ** Label acs samples 
. rename persons_* acs1_persons_* 

. rename households_* acs1_households_*

. rename dollars_* acs1_dollars_*

. 
. ** Merge with ACS Data 
. merge 1:1 year fips using "${data}working/acs_county_gross_college
> ", gen(merge_acs_2)

    Result                      Number of obs
    -----------------------------------------
    Not matched                        18,963
        from master                    18,963  (merge_acs_2==1)
        from using                          0  (merge_acs_2==2)

    Matched                             4,825  (merge_acs_2==3)
    -----------------------------------------

. 
. ** Keep require variables 
. keep year fips state* county* *_net_3 *_out_1 *_out_2 *_in_3 *_out
> _3  merge_acs_*

. 
. ** Label acs samples 
. rename persons_* acs2_persons_*

. rename households_* acs2_households_*

. rename dollars_* acs2_dollars_*

. 
. ** Merge with ACS Data 
. merge 1:1 year fips using "${data}working/acs_county_gross_nocolle
> ge", gen(merge_acs_3)

    Result                      Number of obs
    -----------------------------------------
    Not matched                        18,963
        from master                    18,963  (merge_acs_3==1)
        from using                          0  (merge_acs_3==2)

    Matched                             4,825  (merge_acs_3==3)
    -----------------------------------------

. 
. ** Keep require variables 
. keep year fips state* county* *_net_3 *_out_1 *_out_2 *_in_3 *_out
> _3 merge_acs_*

. 
. ** Label acs samples 
. rename persons_* acs3_persons_*

. rename households_* acs3_households_*

. rename dollars_* acs3_dollars_*

. 
. ** TODO add High and Low Education Samples 
. 
. ** Drop "other counties"
. drop if county_fips == 0
(483 observations deleted)

. drop if year == 2015 
(430 observations deleted)

. 
. ** Merge with Demographic data 
. merge m:1 fips using "${data}working/demographics_2020",        //
> /
>         gen(demo_merge) keep(master match)

    Result                      Number of obs
    -----------------------------------------
    Not matched                            27
        from master                        27  (demo_merge==1)
        from using                          0  (demo_merge==2)

    Matched                            22,848  (demo_merge==3)
    -----------------------------------------

.         
. ** Show match 
. tab state_name demo_merge, m

                     | Matching result from
                     |         merge
          State name | Master on  Matched ( |     Total
---------------------+----------------------+----------
                     |        21          0 |        21 
             Alabama |         0        479 |       479 
              Alaska |         6        198 |       204 
             Arizona |         0        113 |       113 
            Arkansas |         0        531 |       531 
          California |         0        474 |       474 
            Colorado |         0        452 |       452 
         Connecticut |         0         48 |        48 
            Delaware |         0         27 |        27 
District of Columbia |         0          9 |         9 
             Florida |         0        535 |       535 
             Georgia |         0      1,157 |     1,157 
              Hawaii |         0         34 |        34 
               Idaho |         0        310 |       310 
            Illinois |         0        740 |       740 
             Indiana |         0        676 |       676 
                Iowa |         0        703 |       703 
              Kansas |         0        741 |       741 
            Kentucky |         0        854 |       854 
           Louisiana |         0        462 |       462 
               Maine |         0        116 |       116 
            Maryland |         0        190 |       190 
       Massachusetts |         0        116 |       116 
            Michigan |         0        613 |       613 
           Minnesota |         0        625 |       625 
         Mississippi |         0        580 |       580 
            Missouri |         0        819 |       819 
             Montana |         0        394 |       394 
            Nebraska |         0        657 |       657 
              Nevada |         0        123 |       123 
       New Hampshire |         0         70 |        70 
          New Jersey |         0        181 |       181 
          New Mexico |         0        235 |       235 
            New York |         0        476 |       476 
      North Carolina |         0        736 |       736 
        North Dakota |         0        373 |       373 
                Ohio |         0        658 |       658 
            Oklahoma |         0        547 |       547 
              Oregon |         0        268 |       268 
        Pennsylvania |         0        509 |       509 
        Rhode Island |         0         41 |        41 
      South Carolina |         0        338 |       338 
        South Dakota |         0        462 |       462 
           Tennessee |         0        687 |       687 
               Texas |         0      1,854 |     1,854 
                Utah |         0        213 |       213 
             Vermont |         0        100 |       100 
            Virginia |         0        951 |       951 
          Washington |         0        293 |       293 
       West Virginia |         0        387 |       387 
           Wisconsin |         0        530 |       530 
             Wyoming |         0        163 |       163 
---------------------+----------------------+----------
               Total |        27     22,848 |    22,875 

. tab year demo_merge, m

  Tax year |
     (year | Matching result from
    before |         merge
     move) | Master on  Matched ( |     Total
-----------+----------------------+----------
      2016 |         0      3,140 |     3,140 
      2017 |         0      3,140 |     3,140 
      2018 |         0      3,140 |     3,140 
      2019 |         0      3,140 |     3,140 
      2020 |         2      3,140 |     3,142 
      2021 |         2      3,141 |     3,143 
      2022 |         9      3,133 |     3,142 
      2023 |         7        437 |       444 
      2024 |         7        437 |       444 
-----------+----------------------+----------
     Total |        27     22,848 |    22,875 

. 
. ** Keep if matched 
. keep if demo_merge == 3
(27 observations deleted)

. drop demo_merge

. 
. ** Rename 
. rename population pop_census

.         
. ** Merge with Demographic data 
. merge m:1 year fips using "${data}working/bea_economics",       //
> /
>         gen(econ_merge) keep(master match) 

    Result                      Number of obs
    -----------------------------------------
    Not matched                           366
        from master                       366  (econ_merge==1)
        from using                          0  (econ_merge==2)

    Matched                            22,482  (econ_merge==3)
    -----------------------------------------

.         
. ** Show match 
. tab state_name econ_merge, m

                     | Matching result from
                     |         merge
          State name | Master on  Matched ( |     Total
---------------------+----------------------+----------
             Alabama |         0        479 |       479 
              Alaska |         0        198 |       198 
             Arizona |         0        113 |       113 
            Arkansas |         0        531 |       531 
          California |         0        474 |       474 
            Colorado |         0        452 |       452 
         Connecticut |         0         48 |        48 
            Delaware |         0         27 |        27 
District of Columbia |         0          9 |         9 
             Florida |         0        535 |       535 
             Georgia |         0      1,157 |     1,157 
              Hawaii |         9         25 |        34 
               Idaho |         0        310 |       310 
            Illinois |         0        740 |       740 
             Indiana |         0        676 |       676 
                Iowa |         0        703 |       703 
              Kansas |         0        741 |       741 
            Kentucky |         0        854 |       854 
           Louisiana |         0        462 |       462 
               Maine |         0        116 |       116 
            Maryland |         0        190 |       190 
       Massachusetts |         0        116 |       116 
            Michigan |         0        613 |       613 
           Minnesota |         0        625 |       625 
         Mississippi |         0        580 |       580 
            Missouri |         0        819 |       819 
             Montana |         0        394 |       394 
            Nebraska |         0        657 |       657 
              Nevada |         0        123 |       123 
       New Hampshire |         0         70 |        70 
          New Jersey |         0        181 |       181 
          New Mexico |         0        235 |       235 
            New York |         0        476 |       476 
      North Carolina |         0        736 |       736 
        North Dakota |         0        373 |       373 
                Ohio |         0        658 |       658 
            Oklahoma |         0        547 |       547 
              Oregon |         0        268 |       268 
        Pennsylvania |         0        509 |       509 
        Rhode Island |         0         41 |        41 
      South Carolina |         0        338 |       338 
        South Dakota |         0        462 |       462 
           Tennessee |         0        687 |       687 
               Texas |         0      1,854 |     1,854 
                Utah |         0        213 |       213 
             Vermont |         0        100 |       100 
            Virginia |       357        594 |       951 
          Washington |         0        293 |       293 
       West Virginia |         0        387 |       387 
           Wisconsin |         0        530 |       530 
             Wyoming |         0        163 |       163 
---------------------+----------------------+----------
               Total |       366     22,482 |    22,848 

. tab year econ_merge, m

  Tax year |
     (year | Matching result from
    before |         merge
     move) | Master on  Matched ( |     Total
-----------+----------------------+----------
      2016 |        52      3,088 |     3,140 
      2017 |        52      3,088 |     3,140 
      2018 |        52      3,088 |     3,140 
      2019 |        52      3,088 |     3,140 
      2020 |        52      3,088 |     3,140 
      2021 |        53      3,088 |     3,141 
      2022 |        53      3,080 |     3,133 
      2023 |         0        437 |       437 
      2024 |         0        437 |       437 
-----------+----------------------+----------
     Total |       366     22,482 |    22,848 

. 
. ** Keep if matched 
. keep if econ_merge == 3
(366 observations deleted)

. drop econ_merge

. 
. ** Merge with COVID-19 Data
. merge m:1 fips using ${data}working/covid_cleaned_wide.dta,     //
> /
>         gen(covid_merge) keep(master match )
(variable state_name was str20, now str24 to accommodate using
       data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                            73
        from master                        73  (covid_merge==1)
        from using                          0  (covid_merge==2)

    Matched                            22,409  (covid_merge==3)
    -----------------------------------------

. 
. ** Show match 
. tab state_name covid_merge, m

                      | Matching result from
                      |         merge
           State name | Master on  Matched ( |     Total
----------------------+----------------------+----------
              Alabama |         0        479 |       479 
               Alaska |        28        170 |       198 
              Arizona |         0        113 |       113 
             Arkansas |         0        531 |       531 
           California |         0        474 |       474 
             Colorado |         0        452 |       452 
          Connecticut |         0         48 |        48 
             Delaware |         0         27 |        27 
 District of Columbia |         0          9 |         9 
              Florida |         0        535 |       535 
              Georgia |         0      1,157 |     1,157 
               Hawaii |         0         25 |        25 
                Idaho |         0        310 |       310 
             Illinois |         0        740 |       740 
              Indiana |         0        676 |       676 
                 Iowa |         0        703 |       703 
               Kansas |         0        741 |       741 
             Kentucky |         0        854 |       854 
            Louisiana |         0        462 |       462 
                Maine |         0        116 |       116 
             Maryland |         0        190 |       190 
        Massachusetts |         0        116 |       116 
             Michigan |         0        613 |       613 
            Minnesota |         0        625 |       625 
          Mississippi |         0        580 |       580 
             Missouri |         0        819 |       819 
              Montana |         0        394 |       394 
             Nebraska |         0        657 |       657 
               Nevada |         0        123 |       123 
        New Hampshire |         0         70 |        70 
           New Jersey |         0        181 |       181 
           New Mexico |         0        235 |       235 
             New York |        45        431 |       476 
       North Carolina |         0        736 |       736 
         North Dakota |         0        373 |       373 
                 Ohio |         0        658 |       658 
             Oklahoma |         0        547 |       547 
               Oregon |         0        268 |       268 
         Pennsylvania |         0        509 |       509 
         Rhode Island |         0         41 |        41 
       South Carolina |         0        338 |       338 
         South Dakota |         0        462 |       462 
            Tennessee |         0        687 |       687 
                Texas |         0      1,854 |     1,854 
                 Utah |         0        213 |       213 
              Vermont |         0        100 |       100 
             Virginia |         0        594 |       594 
           Washington |         0        293 |       293 
        West Virginia |         0        387 |       387 
            Wisconsin |         0        530 |       530 
              Wyoming |         0        163 |       163 
----------------------+----------------------+----------
                Total |        73     22,409 |    22,482 

. tab year covid_merge, m

  Tax year |
     (year | Matching result from
    before |         merge
     move) | Master on  Matched ( |     Total
-----------+----------------------+----------
      2016 |         9      3,079 |     3,088 
      2017 |         9      3,079 |     3,088 
      2018 |         9      3,079 |     3,088 
      2019 |         9      3,079 |     3,088 
      2020 |         9      3,079 |     3,088 
      2021 |         9      3,079 |     3,088 
      2022 |         9      3,071 |     3,080 
      2023 |         5        432 |       437 
      2024 |         5        432 |       437 
-----------+----------------------+----------
     Total |        73     22,409 |    22,482 

. 
. ** Organize data 
. order year fips state_* county_* 

. sort fips year  

. isid fips year 

. 
. ** Keep only sample with non-missing base populations
. tab county_name year if (missing(n1_out_1 ) | n1_out_1 == 0 ) & ye
> ar <= 2022

                      |  Tax year
                      |   (year
                      |   before
                      |   move)
          County name |      2017 |     Total
----------------------+-----------+----------
        Loving County |         1 |         1 
----------------------+-----------+----------
                Total |         1 |         1 

. drop if (missing(n1_out_1 ) | n1_out_1 == 0 ) & year <= 2022
(1 observation deleted)

. 
. ** Keep only sample with observations in each year 
. bysort fips: gen ct = _N

. tab county_name state_name if ct < 7 

                      |      State name
          County name | Connect..      Texas |     Total
----------------------+----------------------+----------
     Fairfield County |         6          0 |         6 
      Hartford County |         6          0 |         6 
    Litchfield County |         6          0 |         6 
        Loving County |         0          6 |         6 
     Middlesex County |         6          0 |         6 
     New Haven County |         6          0 |         6 
    New London County |         6          0 |         6 
       Tolland County |         6          0 |         6 
       Windham County |         6          0 |         6 
----------------------+----------------------+----------
                Total |        48          6 |        54 

. drop if ct < 7 
(54 observations deleted)

. drop ct 

. 
. ** Generate IRS sample 
. gen irs_sample_1 = inrange(year, 2016, 2022) 

. gen irs_sample_2 = inrange(year, 2016, 2022) & merge_acs_1 != 1 

. 
. ** Generate ACS Period Indicators 
. gen acs_period_1 = merge_acs_1 != 1 & inrange(year, 2016, 2022)

. gen acs_period_2 = merge_acs_1 != 1 

. 
. ** Make sure we have a balanced panel of ACS counties 
. gen tmp = merge_acs_1 != 1 

. bysort fips: egen ct_tmp = total(tmp)

. replace acs_period_1 = 0 if ct_tmp != 9 
(246 real changes made)

. replace acs_period_2 = 0 if ct_tmp != 9 
(342 real changes made)

. replace irs_sample_2 = 0 if ct_tmp != 9
(246 real changes made)

. drop tmp ct_tmp

. 
. tab year irs_sample_1 

  Tax year |
     (year |
    before |     irs_sample_1
     move) |         0          1 |     Total
-----------+----------------------+----------
      2016 |         0      3,079 |     3,079 
      2017 |         0      3,079 |     3,079 
      2018 |         0      3,079 |     3,079 
      2019 |         0      3,079 |     3,079 
      2020 |         0      3,079 |     3,079 
      2021 |         0      3,079 |     3,079 
      2022 |         0      3,079 |     3,079 
      2023 |       437          0 |       437 
      2024 |       437          0 |       437 
-----------+----------------------+----------
     Total |       874     21,553 |    22,427 

. tab year irs_sample_2 

  Tax year |
     (year |
    before |     irs_sample_2
     move) |         0          1 |     Total
-----------+----------------------+----------
      2016 |     2,690        389 |     3,079 
      2017 |     2,690        389 |     3,079 
      2018 |     2,690        389 |     3,079 
      2019 |     2,690        389 |     3,079 
      2020 |     2,690        389 |     3,079 
      2021 |     2,690        389 |     3,079 
      2022 |     2,690        389 |     3,079 
      2023 |       437          0 |       437 
      2024 |       437          0 |       437 
-----------+----------------------+----------
     Total |    19,704      2,723 |    22,427 

. tab year acs_period_1 

  Tax year |
     (year |
    before |     acs_period_1
     move) |         0          1 |     Total
-----------+----------------------+----------
      2016 |     2,690        389 |     3,079 
      2017 |     2,690        389 |     3,079 
      2018 |     2,690        389 |     3,079 
      2019 |     2,690        389 |     3,079 
      2020 |     2,690        389 |     3,079 
      2021 |     2,690        389 |     3,079 
      2022 |     2,690        389 |     3,079 
      2023 |       437          0 |       437 
      2024 |       437          0 |       437 
-----------+----------------------+----------
     Total |    19,704      2,723 |    22,427 

. tab year acs_period_2

  Tax year |
     (year |
    before |     acs_period_2
     move) |         0          1 |     Total
-----------+----------------------+----------
      2016 |     2,690        389 |     3,079 
      2017 |     2,690        389 |     3,079 
      2018 |     2,690        389 |     3,079 
      2019 |     2,690        389 |     3,079 
      2020 |     2,690        389 |     3,079 
      2021 |     2,690        389 |     3,079 
      2022 |     2,690        389 |     3,079 
      2023 |        48        389 |       437 
      2024 |        48        389 |       437 
-----------+----------------------+----------
     Total |    18,926      3,501 |    22,427 

. tab state_name acs_period_1     

                      |     acs_period_1
           State name |         0          1 |     Total
----------------------+----------------------+----------
              Alabama |       458         21 |       479 
               Alaska |       191          7 |       198 
              Arizona |        92         21 |       113 
             Arkansas |       510         21 |       531 
           California |       236        238 |       474 
             Colorado |       445          7 |       452 
             Delaware |         6         21 |        27 
 District of Columbia |         2          7 |         9 
              Florida |       339        196 |       535 
              Georgia |     1,017        140 |     1,157 
               Hawaii |        11         14 |        25 
                Idaho |       303          7 |       310 
             Illinois |       656         84 |       740 
              Indiana |       564        112 |       676 
                 Iowa |       675         28 |       703 
               Kansas |       720         21 |       741 
             Kentucky |       819         35 |       854 
            Louisiana |       413         49 |       462 
                Maine |       102         14 |       116 
             Maryland |       113         77 |       190 
        Massachusetts |       102         14 |       116 
             Michigan |       501        112 |       613 
            Minnesota |       583         42 |       625 
          Mississippi |       559         21 |       580 
             Missouri |       784         35 |       819 
              Montana |       394          0 |       394 
             Nebraska |       636         21 |       657 
               Nevada |       109         14 |       123 
        New Hampshire |        70          0 |        70 
           New Jersey |        62        119 |       181 
           New Mexico |       221         14 |       235 
             New York |       336        140 |       476 
       North Carolina |       610        126 |       736 
         North Dakota |       366          7 |       373 
                 Ohio |       525        133 |       658 
             Oklahoma |       526         21 |       547 
               Oregon |       219         49 |       268 
         Pennsylvania |       369        140 |       509 
         Rhode Island |        20         21 |        41 
       South Carolina |       331          7 |       338 
         South Dakota |       462          0 |       462 
            Tennessee |       638         49 |       687 
                Texas |     1,581        266 |     1,847 
                 Utah |       178         35 |       213 
              Vermont |       100          0 |       100 
             Virginia |       531         63 |       594 
           Washington |       230         63 |       293 
        West Virginia |       387          0 |       387 
            Wisconsin |       439         91 |       530 
              Wyoming |       163          0 |       163 
----------------------+----------------------+----------
                Total |    19,704      2,723 |    22,427 

.         
. ** Define treated state 
. gen multnomah = state_fips == 41 & county_fips == 51

. label var multnomah "Indicator for Multnomah County, Oregon"    

. 
. ** Define treatment indicator 
. gen Treated = multnomah == 1 & year > 2020

. label var Treated "Treatment indicator for Multnomah County, Orego
> n"    

. 
. ** Define sample 1: All counties 
. gen sample_all = 1 

. label var sample_all "All counties (excluding AK, CA, HI OR, WA)"

. 
. ** Define sample 2: Counties in top 95 percent 
. summ percent_urban if year == 2020, de 

            Percent of population in urban areas
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs               3,079
25%            0              0       Sum of wgt.       3,079

50%     .3256337                      Mean           .3521437
                        Largest       Std. dev.       .332065
75%     .6326353              1
90%      .847923              1       Variance       .1102672
95%     .9372299              1       Skewness       .3661052
99%     .9972304              1       Kurtosis       1.763629

. local cutoff = r(p95) 

. tab state_name multnomah if percent_urban >= `cutoff' & year == 20
> 20

                      |     Indicator for
                      |   Multnomah County,
                      |        Oregon
           State name |         0          1 |     Total
----------------------+----------------------+----------
               Alaska |         1          0 |         1 
              Arizona |         1          0 |         1 
           California |        15          0 |        15 
             Colorado |         4          0 |         4 
             Delaware |         1          0 |         1 
 District of Columbia |         1          0 |         1 
              Florida |        13          0 |        13 
              Georgia |         8          0 |         8 
               Hawaii |         1          0 |         1 
                Idaho |         1          0 |         1 
             Illinois |         5          0 |         5 
              Indiana |         3          0 |         3 
                 Iowa |         1          0 |         1 
               Kansas |         2          0 |         2 
             Kentucky |         2          0 |         2 
            Louisiana |         3          0 |         3 
             Maryland |         3          0 |         3 
        Massachusetts |         5          0 |         5 
             Michigan |         3          0 |         3 
            Minnesota |         3          0 |         3 
             Missouri |         4          0 |         4 
             Nebraska |         2          0 |         2 
               Nevada |         3          0 |         3 
           New Jersey |        10          0 |        10 
           New Mexico |         2          0 |         2 
             New York |         9          0 |         9 
       North Carolina |         4          0 |         4 
                 Ohio |         6          0 |         6 
             Oklahoma |         1          0 |         1 
               Oregon |         1          1 |         2 
         Pennsylvania |         4          0 |         4 
         Rhode Island |         2          0 |         2 
            Tennessee |         2          0 |         2 
                Texas |        11          0 |        11 
                 Utah |         4          0 |         4 
             Virginia |        10          0 |        10 
           Washington |         1          0 |         1 
            Wisconsin |         1          0 |         1 
----------------------+----------------------+----------
                Total |       153          1 |       154 

. gen sample_urban95 = percent_urban >= `cutoff' // All counties 

. label var sample_urban95 "Urban counties (top 5%) (excluding AK, C
> A, HI OR, WA)"

. tab sample_urban95 if year == 2020

      Urban |
   counties |
   (top 5%) |
 (excluding |
 AK, CA, HI |
    OR, WA) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,925       95.00       95.00
          1 |        154        5.00      100.00
------------+-----------------------------------
      Total |      3,079      100.00

. 
. ** Define sample 3: Counties in top 98 percent 
. local cutoff = .9864539 //

. tab state_name multnomah if percent_urban >= `cutoff' & year == 20
> 20

                      |     Indicator for
                      |   Multnomah County,
                      |        Oregon
           State name |         0          1 |     Total
----------------------+----------------------+----------
           California |         6          0 |         6 
             Colorado |         2          0 |         2 
 District of Columbia |         1          0 |         1 
              Florida |         4          0 |         4 
              Georgia |         5          0 |         5 
             Illinois |         2          0 |         2 
              Indiana |         1          0 |         1 
            Louisiana |         1          0 |         1 
             Maryland |         1          0 |         1 
        Massachusetts |         1          0 |         1 
             Michigan |         1          0 |         1 
            Minnesota |         1          0 |         1 
             Missouri |         1          0 |         1 
               Nevada |         1          0 |         1 
           New Jersey |         6          0 |         6 
             New York |         7          0 |         7 
       North Carolina |         1          0 |         1 
                 Ohio |         1          0 |         1 
               Oregon |         0          1 |         1 
         Pennsylvania |         2          0 |         2 
         Rhode Island |         1          0 |         1 
                Texas |         3          0 |         3 
                 Utah |         2          0 |         2 
             Virginia |         8          0 |         8 
            Wisconsin |         1          0 |         1 
----------------------+----------------------+----------
                Total |        60          1 |        61 

. gen sample_urban98 = percent_urban >= `cutoff' // All counties 

. label var sample_urban98 "Urban counties (top 1%) (excluding AK, C
> A, HI OR, WA)"

. tab sample_urban98 if year == 2020

      Urban |
   counties |
   (top 1%) |
 (excluding |
 AK, CA, HI |
    OR, WA) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      3,018       98.02       98.02
          1 |         61        1.98      100.00
------------+-----------------------------------
      Total |      3,079      100.00

. 
. ** Define Sample of States      
. drop if state_name == "Alaska"
(198 observations deleted)

. drop if state_name == "Hawaii"
(25 observations deleted)

. drop if state_name == "California"
(474 observations deleted)

. drop if state_name == "Washington"
(293 observations deleted)

. drop if state_name == "Oregon" & multnomah == 0
(259 observations deleted)

. 
. ** Define sample 4: Counties in top 95 + covid 
. cluster kmeans cases_cum* deaths_cum* if        ///
>         sample_urban95 == 1 & year == 2020 & covid_merge == 3 , k(
> 5) gen(kmean)
cluster name: _clus_1

. bysort fips: egen kmean_group = mean(kmean)
(20,046 missing values generated)

. 
. ** Pull out kmeans cluster with Multnoma
. gen tmp1 = kmean if sample_urban95 == 1 & year == 2020 & covid_mer
> ge == 3 & multnomah == 1 
(21,177 missing values generated)

. egen tmp2 = mean(tmp1)

. gen sample_urban95_covid = sample_urban95 == 1 & kmean_group == tm
> p2

. drop tmp1 tmp2 

. label var sample_urban95_covid "Urban counties (top 5%) w. Kmean C
> ovid Match  (excluding AK, CA, HI OR, WA)"

. tab sample_urban95_covid if year == 2020

      Urban |
   counties |
(top 5%) w. |
Kmean Covid |
      Match |
 (excluding |
 AK, CA, HI |
    OR, WA) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,879       98.73       98.73
          1 |         37        1.27      100.00
------------+-----------------------------------
      Total |      2,916      100.00

. 
. ** Show results across clusters 
. preserve 

. 
. ** Keep required variables 
. keep if sample_urban95 == 1 & year == 2020 & covid_merge == 3
(21,048 observations deleted)

. keep kmean cases_cum* deaths_cum* population

. collapse (mean) cases_cum* deaths_cum* [fw = population], by(kmean
> )

. reshape long cases_cum deaths_cum, i(kmean) j(time)
(j = 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 
> 25 26 27 28 29)

Data                               Wide   ->   Long
--------------------------------------------------------------------
> ---------
Number of observations                5   ->   145         
Number of variables                  59   ->   4           
j variable (29 values)                    ->   time
xij variables:
  cases_cum1 cases_cum2 ... cases_cum29   ->   cases_cum
deaths_cum1 deaths_cum2 ... deaths_cum29  ->   deaths_cum
--------------------------------------------------------------------
> ---------

. xtset kmean time 

Panel variable: kmean (strongly balanced)
 Time variable: time, 1 to 29
         Delta: 1 unit

. xtline cases_cum 

. graph export "${results}fig_kmeans.jpg", as(jpg) name("Graph") qua
> lity(100) replace             
file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/fi
> g_kmeans.jpg written in JPEG format

. clear  

. 
. ** Restore      
. restore 

. 
. ** Define covariates 
. local covariates "population per_capita_income"

. 
. ** Standardize covariates 
. foreach v of local covariates {
  2.         egen tmp_v = std(`v') 
  3.         replace `v' = tmp_v
  4.         drop tmp_v
  5. } // END COVAR LOOP 
(21,178 real changes made)
(21,178 real changes made)

. 
. ** Define outcome variables (IRS)
. foreach x in "n1" "n2" "agi" {
  2.         
.         if "`x'" == "n1" local xtxt "returns"
  3.         else if "`x'" == "n2" local xtxt "exemptions"
  4.         else if "`x'" == "agi" local xtxt "AGI"
  5.         
.         ** Loop over migration type 
.         foreach y in "net" "in" "out" {
  6.                 
.                         if "`y'" == "net" local ytxt "Net domestic
>  migration"
  7.                         else if "`y'" == "in" local ytxt "Domes
> tic in-migration"
  8.                         else if "`y'" == "out" local ytxt "Dome
> stic out-migration"
  9.                 
.                         ** Generate
.                         gen `x'_`y'_rate_irs = 100 * (`x'_`y'_3 / 
> (`x'_out_1 + `x'_out_2))
 10. 
.                         ** Label var 
.                         label var `x'_`y'_rate_irs      "`ytxt' ra
> te, `xtxt' (%)"
 11.                         
.         } // END MIGRATION TYPE LOOP 
 12.         
. } // END OUTCOME TYPE LOOP 
(766 missing values generated)
(766 missing values generated)
(766 missing values generated)
(766 missing values generated)
(766 missing values generated)
(766 missing values generated)
(766 missing values generated)
(766 missing values generated)
(766 missing values generated)

. 
. ** Define outcome variables (ACS)
. 
. ** Rename for loop 
. rename acs*_households_* acs*_n1_*

. rename acs*_persons_* acs*_n2_*

. rename acs*_dollars_* acs*_agi_*

. 
. ** Loop over sample 
. ** (18+ = 1, college degree == 2, no college degree == 3)
. forvalues i = 1/3{
  2.         
.         if `i' == 1 local itxt ""
  3.         else if `i' == 2 local itxt " (College)"
  4.         else if `i' == 3 local itxt " (No College)"
  5.         
. 
.         ** Define outcome variables (IRS)
.         foreach x in "n1" "n2" "agi" {
  6.                 
.                 if "`x'" == "n1" local xtxt "HHs"
  7.                 else if "`x'" == "n2" local xtxt "persons"
  8.                 else if "`x'" == "agi" local xtxt "total income
> "
  9.         
.                 
.                 ** Loop over migration type 
.                 foreach y in "net" "in" "out" {
 10.                         
.                                 if "`y'" == "net" local ytxt "Net 
> domestic migration"
 11.                                 else if "`y'" == "in" local ytx
> t "Domestic in-migration"
 12.                                 else if "`y'" == "out" local yt
> xt "Domestic out-migration"
 13.                         
.                                 ** Generate
.                                 gen `x'_`y'_rate_acs`i' = 100 * (a
> cs`i'_`x'_`y'_3 / (acs`i'_`x'_out_1 + acs`i'_`x'_out_2))
 14. 
.                                 ** Label var 
.                                 label var `x'_`y'_rate_acs`i' "`yt
> xt' rate, `xtxt'`itxt' (%)"
 15.                                 
.                 } // END MIGRATION TYPE LOOP 
 16.                 
.         } // END OUTCOME TYPE LOOP 
 17.         
. } // END SAMPLE LOOP 
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)
(17,815 missing values generated)

. 
. ** Declare panel
. xtset fips year 

Panel variable: fips (unbalanced)
 Time variable: year, 2016 to 2024
         Delta: 1 unit

. 
. ** Tag unique fips 
. egen unique = tag(fips)

. tab year unique

  Tax year |
     (year |
    before |       tag(fips)
     move) |         0          1 |     Total
-----------+----------------------+----------
      2016 |         0      2,916 |     2,916 
      2017 |     2,916          0 |     2,916 
      2018 |     2,916          0 |     2,916 
      2019 |     2,916          0 |     2,916 
      2020 |     2,916          0 |     2,916 
      2021 |     2,916          0 |     2,916 
      2022 |     2,916          0 |     2,916 
      2023 |       383          0 |       383 
      2024 |       383          0 |       383 
-----------+----------------------+----------
     Total |    18,262      2,916 |    21,178 

. 
. ** Before your loops, set up a postfile
. tempname weights

. postfile `weights' str30 data str40 outcome str30 sample covariate
> s excl_2020 fips weight using "${results}sdid_weights.dta", replac
> e

. 
. ** Loop over IRS and ACS Samples  
. foreach data of varlist irs_sample_1 irs_sample_2 acs_period_1 acs
> _period_2  {
  2. 
.         ** Different sets of outcome variables 
.         if "`data'" == "irs_sample_1" local out_type "irs"
  3.         else if "`data'" == "irs_sample_2" local out_type "irs"
  4.         else local out_type "acs1 acs2"
  5. 
.         ** Loop over Outcome var type 
.         foreach type of local out_type {
  6.                 
.                 ** Labels 
.                 if "`data'" == "irs_sample_1" local out_txt "irs_f
> ull_16_22"
  7.                 if "`data'" == "irs_sample_1" local out_txt "ir
> s_389_16_22"
  8.                 else if "`data'" == "acs_period_1" & "`type'" =
> = "acs1" local out_txt "acs_16_22_all"
  9.                 else if "`data'" == "acs_period_1" & "`type'" =
> = "acs2" local out_txt "acs_16_22_col"
 10.                 else if "`data'" == "acs_period_1" & "`type'" =
> = "acs3" local out_txt "acs_16_22_noc"
 11.                 else if "`data'" == "acs_period_1" & "`type'" =
> = "acs4" local out_txt "acs_16_22_3D"
 12.                 else if "`data'" == "acs_period_2" & "`type'" =
> = "acs1" local out_txt "acs_16_24_all"
 13.                 else if "`data'" == "acs_period_2" & "`type'" =
> = "acs2" local out_txt "acs_16_24_col"
 14.                 else if "`data'" == "acs_period_2" & "`type'" =
> = "acs3" local out_txt "acs_16_24_noc"
 15.                 else if "`data'" == "acs_period_2" & "`type'" =
> = "acs4" local out_txt "acs_16_24_3D"
 16. 
.                 ** Loop over samples 
.                 foreach samp of varlist sample_all sample_urban95 
> sample_urban95_covid {        
 17.                         
.                         ** Loop over exclusion of 2019-2020 period
>  
.                         forvalues exl = 1(-1)0 {
 18.                                 
.                                 ** Define sample        
.                                 gen sample = `samp' == 1 & `data' 
> == 1 
 19.                                 if `exl' == 1 replace sample = 
> 0 if year == 2020 
 20.                                 
.                                 ** Clear stored values 
.                                 eststo clear 
 21.                                 
.                                 ** Loop over migration type 
.                                 foreach migr in "net" "in" "out" {
 22.                                         
.                                         ** Loop over outcomes 
.                                         foreach out of varlist  n1
> _`migr'_rate_`type'   ///
>                                                                   
>                       n2_`migr'_rate_`type'   ///
>                                                                   
>                       agi_`migr'_rate_`type' {
 23.                                         
.                                                 ** Store label 
.                                                 local label : vari
> able label `out'
 24.                                                 
.                                                 ** Loop over inclu
> sion of covariates
.                                                 forvalues c = 0/1 
> {
 25.                                                 
.                                                         ** Covaria
> tes 
.                                                         if `c' == 
> 0 local covars ""
 26.                                                         else if
>  `c' == 1 local covars "covariates(`covariates', projected)"
 27.                                                         
.                                                         ** File Na
> me 
.                                                         if `exl' =
> = 0 local path "${results}fig_`out_txt'_`out'_`c'_`samp'_"
 28.                                                         if `exl
> ' == 1 local path "${results}fig_`out_txt'_`out'_`c'_`samp'_excl20
> 20_"
 29.                 
.                                                         dis "`out'
> "
 30.                                                         
.                                                         ** Run SDI
> D
.                                                         eststo sdi
> d_`out'_`c': sdid `out' fips year Treated     ///
>                                                                 if
>  sample == 1,                         ///
>                                                                 vc
> e(placebo)                            ///
>                                                                 `c
> ovar'                                         ///
>                                                                 re
> ps(`reps')                            ///
>                                                                 gr
> aph graph_export("`path'", .pdf) 
 31.                                                                
>  
.                                                         
.                                                                 **
>  Then after each sdid command, add:
.                                                                 ma
> trix omega = e(omega)
 32.                                                                
>  local colnames : colnames omega
 33.                                                                
>  local i = 1
 34.                                                                
>  foreach county of local colnames {
 35.                                                                
>          local wt = omega[1, `i']
 36.                                                                
>          local fips = omega[2, `i']
 37.                                                                
>          dis "`wt'"
 38.                                                                
>          dis "`county'"
 39.                                                                
>          dis "`fips'"
 40.                                                                
>          post    `weights'       ///
>                                                                   
>                       ("`data'")      ///
>                                                                   
>                       ("`out'")       ///
>                                                                   
>                       ("`samp'")      ///
>                                                                   
>                       (`c')           ///
>                                                                   
>                       (`exl')         ///
>                                                                   
>                       (`fips')        ///
>                                                                   
>                       (`wt')
 41.                                                                
>          local i = `i' + 1
 42.                                                                
>  }
 43. 
.                                                                 
.                                                         ** ADD COD
> E PRESERVING WEIGHTS  
.                                                                 
.                                                         ** Estadd 
> counties  
.                                                         qui summ `
> out' if year == 2021 & sample == 1
 44.                                                         estadd 
> scalar count = r(N)      
 45.                                                                
>  
.                                                         ** Estadd 
> mean 
.                                                         qui summ `
> out' if multnomah == 1 & Treated == 0 
 46.                                                         estadd 
> scalar mean = r(mean)
 47. 
.                                                         ** Run eve
> nt-study 
.                                                         sdid_event
>  `out' fips year Treated                      ///
>                                                                 if
>  sample == 1,                                         ///
>                                                                 `c
> ovar'                                                         ///
>                                                                 vc
> e(placebo)                                            ///
>                                                                 br
> ep(`reps')                                            ///
>                                                                 pl
> acebo(all)
 48.                                                         
.                                                         ** Create 
> Figure 
.                                                         
.                                                         ** Store m
> ax year 
.                                                         qui summ y
> ear if multnomah == 1 & sample == 1
 49.                                                         local m
> ax_yr = r(max)
 50.                                                         dis "`m
> ax_yr'"
 51.                                                         
.                                                         ** Move re
> sults from matrix to data 
.                                                         qui count 
> if multnomah == 1 & sample == 1
 52.                                                         local c
> t = r(N)
 53.                                                         local c
> t = `ct' + 1
 54.                                                         matrix 
> list e(H)
 55.                                                         mat res
>  = e(H)[2..`ct',1..5]
 56.                                 
.                                                         ** Move Ma
> trix results to data 
.                                                         svmat res
 57.                                                         
.                                                         ** Generat
> e ID variable
.                                                         gen id = `
> max_yr' - _n + 1 if !missing(res1)
 58.                                                         
.                                                         ** Update 
> labeling for exclusion of 
.                                                         if `exl' =
> = 1 {
 59.                                                                
>  replace id = id - 1 if id <= 2020 
 60.                                                                
>  expand 2 if id == 2019, gen(tag)
 61.                                                                
>  replace id = 2020 if tag == 1 
 62.                                                                
>  replace res1 = . if tag == 1 
 63.                                                                
>  replace res3 = . if tag == 1 
 64.                                                                
>  replace res4 = . if tag == 1 
 65.                                                         }
 66.                                                         label v
> ar id "Year (destination)"
 67.                                                         
.                                                         ** Sort 
.                                                         sort id
 68.                                                         
.                                                         ** Plot
.                                                         twoway  (r
> cap res3 res4 id, lc(gs10) fc(gs11%50))       ///
>                                                                   
>       (scatter res1 id, mc(black)),                           /// 
>             
>                                                                 le
> gend(off) ytitle("`label'")                                   ///
>                                                                 yl
> ine(0, lc(red) lp(-))                                             
>     ///
>                                                                 xl
> ine(2020.5, lc(black) lp(solid))                              ///
>                                                                 yl
> abel(-10(2.5)10, format(%9.1f))
 69. 
.                                                         if `exl' =
> = 0 local path "${results}fig_`out_txt'_`out'_`c'_`samp'_eventstud
> y.jpg"
 70.                                                         if `exl
> ' == 1 local path "${results}fig_`out_txt'_`out'_`c'_`samp'_excl20
> 20_eventstudy.jpg"
 71.                 
.                                                                 
.                                                         graph expo
> rt "`path'",  ///
>                                                                 as
> (jpg) name("Graph") quality(100) replace              
 72. 
.                                                         ** Clean u
> p 
.                                                         drop res1 
> res2 res3 res4 res5 id 
 73.                                                         if `exl
> ' == 1 {
 74.                                                                
>  drop if tag == 1
 75.                                                                
>  drop tag 
 76.                                                         }
 77.                                                         ** Upda
> te Count
.                                                         local ct =
>  `ct' + 1 
 78.                                                                
>                          
.                                                 } // END COVAR LOO
> P 
 79.                                         
.                                         } // END OUTCOME LOOP 
 80.                                         
.                                         ** Determine name 
.                                         if `exl' == 0 local path "
> ${results}tab_sdid_`out_txt'_`migr'_`samp'.tex"
 81.                                         if `exl' == 1 local pat
> h "${results}tab_sdid_`out_txt_`migr'_`samp'_excl2020.tex"
 82.                                         
. 
.                                         ** Table of results 
.                                         if "`data'" == "irs_sample
> " {
 83.                                         
.                                         esttab  sdid_n1_`migr'_rat
> e_`type'_0 sdid_n1_`migr'_rate_`type'_1       ///
>                                                         sdid_n2_`m
> igr'_rate_`type'_0 sdid_n2_`migr'_rate_`type'_1       ///
>                                                         sdid_agi_`
> migr'_rate_`type'_0 sdid_agi_`migr'_rate_`type'_1 ///
>                                                 using "`path'",   
>                                                       ///
>                                         starlevel("*" 0.10 "**" 0.
> 05 "***" 0.01)                ///
>                                         b(%-9.3f) se(%-9.3f) repla
> ce                                    ///
>                                         mgroups("Returns" "Exempti
> ons" "AGI",                   ///
>                                                 pattern(1 0 1 0 1 
> 0) )                                          ///
>                                         mtitle( "No Covariates" "C
> ovariates"                    ///
>                                                         "No Covari
> ates" "Covariates"                    ///
>                                                         "No Covari
> ates" "Covariates")                   ///
>                                         stats(count mean,         
>                                                       ///
>                                                 fmt(%9.0fc %9.3fc)
>                                                       ///
>                                                 labels("Number of 
> Counties" "Pre-treatment mean"))
 84.                                         }
 85.                                         else {
 86.                                         esttab  sdid_n1_`migr'_
> rate_`type'_0 sdid_n1_`migr'_rate_`type'_1       ///
>                                                         sdid_n2_`m
> igr'_rate_`type'_0 sdid_n2_`migr'_rate_`type'_1       ///
>                                                         sdid_agi_`
> migr'_rate_`type'_0 sdid_agi_`migr'_rate_`type'_1 ///
>                                                 using "`path'",   
>                                                       ///
>                                         starlevel("*" 0.10 "**" 0.
> 05 "***" 0.01)                ///
>                                         b(%-9.3f) se(%-9.3f) repla
> ce                                    ///
>                                         mgroups("Households" "Adul
> ts" "Household Income",       ///
>                                                 pattern(1 0 1 0 1 
> 0) )                                          ///
>                                         mtitle( "No Covariates" "C
> ovariates"                    ///
>                                                         "No Covari
> ates" "Covariates"                    ///
>                                                         "No Covari
> ates" "Covariates")                   ///
>                                         stats(count mean,         
>                                                       ///
>                                                 fmt(%9.0fc %9.3fc)
>                                                       ///
>                                                 labels("Number of 
> Counties" "Pre-treatment mean"))
 87.                                                 
.                                         }
 88. 
.                                 
.                                 } // END MIGRATION TYPE LOOP 
 89.                                 
.                                 ** Drop sample var 
.                                 drop sample 
 90.                                 
.                         } // END EXCLUSION LOOP 
 91.                         
.                 } // END SAMPLE LOOP 
 92.         
.         } // END OUT TYPE 
 93.         
. } // END DATA LOOP 
(2,916 real changes made)
n1_net_rate_irs
Placebo replications (100). This may take some time.
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5
..................................................     50
..................................................     100


Synthetic Difference-in-Differences Estimator

--------------------------------------------------------------------
> ---------
n1_net_rat~s |     ATT     Std. Err.     t      P>|t|    [95% Conf. 
> Interval]
-------------+------------------------------------------------------
> ---------
     Treated |  -1.92529    0.95079    -2.02    0.043    -3.78880   
>  -0.06177
--------------------------------------------------------------------
> ---------
95% CIs and p-values are based on large-sample approximations.
Refer to Arkhangelsky et al., (2021) for theoretical derivations.
file
    C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
    > ig_irs_389_16_22_n1_net_rate_irs_0_sample_all_excl2020_trend
    > s2021.pdf saved as PDF format
.0006731765839353
c1
0
1001
c2
1003

added scalar:
              e(count) =  2916

added scalar:
               e(mean) =  .1434552
Synthetic Difference-in-differences

Boostrap replications (100), placebo mode.
|0% ----------------------------------------- 100%|
|.................................................|


             |  Estimate         SE      LB CI      UB CI 
-------------+--------------------------------------------
         ATT | -1.925286   1.081544  -4.045112    .194539 
    Effect_1 | -2.430048    1.38026  -5.135357   .2752619 
    Effect_2 | -1.420525    1.25864   -3.88746    1.04641 
   Placebo_1 |  .0018158   .0227865  -.0428458   .0464774 
   Placebo_2 | -.0017198    .016253  -.0335757   .0301361 
   Placebo_3 | -.0060693   .0224667   -.050104   .0379653 
   Placebo_4 |  .0088023   .0087624   -.008372   .0259765 

             | Switchers 
-------------+----------
         ATT |         1 
    Effect_1 |         1 
    Effect_2 |         1 
   Placebo_1 |         1 
   Placebo_2 |         1 
   Placebo_3 |         1 
   Placebo_4 |         1 
2022

e(H)[7,5]
             Estimate          SE       LB CI       UB CI
      ATT  -1.9252863   1.0815435  -4.0451116   .19453904
 Effect_1  -2.4300477     1.38026  -5.1353573   .27526188
 Effect_2  -1.4205248   1.2586402  -3.8874596     1.04641
Placebo_1   .00181583   .02278653  -.04284576   .04647743
Placebo_2  -.00171981   .01625301  -.03357571   .03013609
Placebo_3  -.00606931   .02246665  -.05010395   .03796533
Placebo_4   .00880226   .00876239  -.00837201   .02597654

            Switchers
      ATT           1
 Effect_1           1
 Effect_2           1
Placebo_1           1
Placebo_2           1
Placebo_3           1
Placebo_4           1
(21,172 missing values generated)
(4 real changes made)
(1 observation created)
(1 real change made)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
> ig_irs_389_16_22_n1_net_rate_irs_0_sample_all_excl2020_eventstudy.
> jpg not found)
file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/fi
> g_irs_389_16_22_n1_net_rate_irs_0_sample_all_excl2020_eventstudy.j
> pg written in JPEG format
(1 observation deleted)
n1_net_rate_irs
Placebo replications (100). This may take some time.
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5
..................................................     50
..................................................     100


Synthetic Difference-in-Differences Estimator

--------------------------------------------------------------------
> ---------
n1_net_rat~s |     ATT     Std. Err.     t      P>|t|    [95% Conf. 
> Interval]
-------------+------------------------------------------------------
> ---------
     Treated |  -1.92529    0.88515    -2.18    0.030    -3.66014   
>  -0.19043
--------------------------------------------------------------------
> ---------
95% CIs and p-values are based on large-sample approximations.
Refer to Arkhangelsky et al., (2021) for theoretical derivations.
file
    C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
    > ig_irs_389_16_22_n1_net_rate_irs_1_sample_all_excl2020_trend
    > s2021.pdf saved as PDF format
.0006731765839353
c1
0
1001
c2
1003

added scalar:
              e(count) =  2916

added scalar:
               e(mean) =  .1434552
Synthetic Difference-in-differences

Boostrap replications (100), placebo mode.
|0% ----------------------------------------- 100%|
|.................................................|


             |  Estimate         SE      LB CI      UB CI 
-------------+--------------------------------------------
         ATT | -1.925286   .8049941  -3.503075  -.3474978 
    Effect_1 | -2.430048   1.105706  -4.597232  -.2628634 
    Effect_2 | -1.420525   .9638001  -3.309573   .4685234 
   Placebo_1 |  .0018158   .0104778  -.0187206   .0223523 
   Placebo_2 | -.0017198   .0123085  -.0258445   .0224049 
   Placebo_3 | -.0060693   .0139784  -.0334669   .0213283 
   Placebo_4 |  .0088023   .0211694  -.0326899   .0502944 

             | Switchers 
-------------+----------
         ATT |         1 
    Effect_1 |         1 
    Effect_2 |         1 
   Placebo_1 |         1 
   Placebo_2 |         1 
   Placebo_3 |         1 
   Placebo_4 |         1 
2022

e(H)[7,5]
             Estimate          SE       LB CI       UB CI
      ATT  -1.9252863    .8049941  -3.5030747  -.34749783
 Effect_1  -2.4300477   1.1057063  -4.5972321  -.26286335
 Effect_2  -1.4205248   .96380009   -3.309573   .46852337
Placebo_1   .00181583   .01047778  -.01872061   .02235228
Placebo_2  -.00171981   .01230851  -.02584449   .02240487
Placebo_3  -.00606931   .01397837  -.03346693    .0213283
Placebo_4   .00880226   .02116945  -.03268986   .05029438

            Switchers
      ATT           1
 Effect_1           1
 Effect_2           1
Placebo_1           1
Placebo_2           1
Placebo_3           1
Placebo_4           1
(21,172 missing values generated)
(4 real changes made)
(1 observation created)
(1 real change made)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
> ig_irs_389_16_22_n1_net_rate_irs_1_sample_all_excl2020_eventstudy.
> jpg not found)
file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/fi
> g_irs_389_16_22_n1_net_rate_irs_1_sample_all_excl2020_eventstudy.j
> pg written in JPEG format
(1 observation deleted)
n2_net_rate_irs
Placebo replications (100). This may take some time.
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5
..................................................     50
..................................................     100


Synthetic Difference-in-Differences Estimator

--------------------------------------------------------------------
> ---------
n2_net_rat~s |     ATT     Std. Err.     t      P>|t|    [95% Conf. 
> Interval]
-------------+------------------------------------------------------
> ---------
     Treated |  -1.82184    0.83763    -2.17    0.030    -3.46356   
>  -0.18012
--------------------------------------------------------------------
> ---------
95% CIs and p-values are based on large-sample approximations.
Refer to Arkhangelsky et al., (2021) for theoretical derivations.
file
    C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
    > ig_irs_389_16_22_n2_net_rate_irs_0_sample_all_excl2020_trend
    > s2021.pdf saved as PDF format
.0004271535733441
c1
0
1001
c2
1003

added scalar:
              e(count) =  2916

added scalar:
               e(mean) =  -.73591077
Synthetic Difference-in-differences

Boostrap replications (100), placebo mode.
|0% ----------------------------------------- 100%|
|.................................................|


             |  Estimate         SE      LB CI      UB CI 
-------------+--------------------------------------------
         ATT | -1.821837   .9696524  -3.722355   .0786819 
    Effect_1 | -2.268932   1.068665  -4.363515  -.1743494 
    Effect_2 | -1.374741   1.279732  -3.883015   1.133533 
   Placebo_1 |  .0027779   .0254161  -.0470377   .0525935 
   Placebo_2 | -.0013103   .0149063  -.0305266    .027906 
   Placebo_3 | -.0077218   .0147674   -.036666   .0212223 
   Placebo_4 |  .0067843   .0268259  -.0457945   .0593631 

             | Switchers 
-------------+----------
         ATT |         1 
    Effect_1 |         1 
    Effect_2 |         1 
   Placebo_1 |         1 
   Placebo_2 |         1 
   Placebo_3 |         1 
   Placebo_4 |         1 
2022

e(H)[7,5]
             Estimate          SE       LB CI       UB CI
      ATT  -1.8218368   .96965236  -3.7223554   .07868185
 Effect_1  -2.2689324   1.0686648  -4.3635154  -.17434938
 Effect_2  -1.3747411   1.2797316  -3.8830152   1.1335329
Placebo_1    .0027779   .02541613  -.04703771   .05259352
Placebo_2  -.00131033   .01490627  -.03052663   .02790597
Placebo_3  -.00772184   .01476741  -.03666596   .02122228
Placebo_4   .00678431    .0268259  -.04579445   .05936308

            Switchers
      ATT           1
 Effect_1           1
 Effect_2           1
Placebo_1           1
Placebo_2           1
Placebo_3           1
Placebo_4           1
(21,172 missing values generated)
(4 real changes made)
(1 observation created)
(1 real change made)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
> ig_irs_389_16_22_n2_net_rate_irs_0_sample_all_excl2020_eventstudy.
> jpg not found)
file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/fi
> g_irs_389_16_22_n2_net_rate_irs_0_sample_all_excl2020_eventstudy.j
> pg written in JPEG format
(1 observation deleted)
n2_net_rate_irs
Placebo replications (100). This may take some time.
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5
..................................................     50
..................................................     100


Synthetic Difference-in-Differences Estimator

--------------------------------------------------------------------
> ---------
n2_net_rat~s |     ATT     Std. Err.     t      P>|t|    [95% Conf. 
> Interval]
-------------+------------------------------------------------------
> ---------
     Treated |  -1.82184    0.88026    -2.07    0.038    -3.54711   
>  -0.09657
--------------------------------------------------------------------
> ---------
95% CIs and p-values are based on large-sample approximations.
Refer to Arkhangelsky et al., (2021) for theoretical derivations.
file
    C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
    > ig_irs_389_16_22_n2_net_rate_irs_1_sample_all_excl2020_trend
    > s2021.pdf saved as PDF format
.0004271535733441
c1
0
1001
c2
1003

added scalar:
              e(count) =  2916

added scalar:
               e(mean) =  -.73591077
Synthetic Difference-in-differences

Boostrap replications (100), placebo mode.
|0% ----------------------------------------- 100%|
|.................................................|


             |  Estimate         SE      LB CI      UB CI 
-------------+--------------------------------------------
         ATT | -1.821837   1.218071  -4.209256   .5655826 
    Effect_1 | -2.268932   1.581306  -5.368291   .8304265 
    Effect_2 | -1.374741   1.092453  -3.515949   .7664668 
   Placebo_1 |  .0027779   .0269385  -.0500216   .0555774 
   Placebo_2 | -.0013103   .0243818  -.0490986   .0464779 
   Placebo_3 | -.0077218   .0488566  -.1034808   .0880371 
   Placebo_4 |  .0067843   .0355533  -.0629001   .0764687 

             | Switchers 
-------------+----------
         ATT |         1 
    Effect_1 |         1 
    Effect_2 |         1 
   Placebo_1 |         1 
   Placebo_2 |         1 
   Placebo_3 |         1 
   Placebo_4 |         1 
2022

e(H)[7,5]
             Estimate          SE       LB CI       UB CI
      ATT  -1.8218368   1.2180711  -4.2092561   .56558258
 Effect_1  -2.2689324   1.5813056  -5.3682913   .83042648
 Effect_2  -1.3747411    1.092453  -3.5159491   .76646677
Placebo_1    .0027779   .02693853  -.05002162   .05557742
Placebo_2  -.00131033   .02438176  -.04909857   .04647791
Placebo_3  -.00772184   .04885662  -.10348081   .08803713
Placebo_4   .00678431   .03555326  -.06290008   .07646871

            Switchers
      ATT           1
 Effect_1           1
 Effect_2           1
Placebo_1           1
Placebo_2           1
Placebo_3           1
Placebo_4           1
(21,172 missing values generated)
(4 real changes made)
(1 observation created)
(1 real change made)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
> ig_irs_389_16_22_n2_net_rate_irs_1_sample_all_excl2020_eventstudy.
> jpg not found)
file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/fi
> g_irs_389_16_22_n2_net_rate_irs_1_sample_all_excl2020_eventstudy.j
> pg written in JPEG format
(1 observation deleted)
agi_net_rate_irs
Placebo replications (100). This may take some time.
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5
..................................................     50
..................................................     100


Synthetic Difference-in-Differences Estimator

--------------------------------------------------------------------
> ---------
agi_net_ra~s |     ATT     Std. Err.     t      P>|t|    [95% Conf. 
> Interval]
-------------+------------------------------------------------------
> ---------
     Treated |  -3.74944    0.97485    -3.85    0.000    -5.66011   
>  -1.83877
--------------------------------------------------------------------
> ---------
95% CIs and p-values are based on large-sample approximations.
Refer to Arkhangelsky et al., (2021) for theoretical derivations.
file
    C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
    > ig_irs_389_16_22_agi_net_rate_irs_0_sample_all_excl2020_tren
    > ds2021.pdf saved as PDF format
.0003801452691019
c1
.0001157956129586
1001
c2
1003

added scalar:
              e(count) =  2916

added scalar:
               e(mean) =  -.29483641
Synthetic Difference-in-differences

Boostrap replications (100), placebo mode.
|0% ----------------------------------------- 100%|
|.................................................|


             |  Estimate         SE      LB CI      UB CI 
-------------+--------------------------------------------
         ATT | -3.749438   1.198738  -6.098965  -1.399911 
    Effect_1 | -3.942519   1.436163  -6.757399  -1.127638 
    Effect_2 | -3.556357   1.542331  -6.579325  -.5333877 
   Placebo_1 |  .0037643   .0848207  -.1624843   .1700128 
   Placebo_2 | -.0011156   .2437859   -.478936   .4767049 
   Placebo_3 | -.0030111   .0618653  -.1242671    .118245 
   Placebo_4 |  .0023952     .05058  -.0967416    .101532 

             | Switchers 
-------------+----------
         ATT |         1 
    Effect_1 |         1 
    Effect_2 |         1 
   Placebo_1 |         1 
   Placebo_2 |         1 
   Placebo_3 |         1 
   Placebo_4 |         1 
2022

e(H)[7,5]
             Estimate          SE       LB CI       UB CI
      ATT  -3.7494376   1.1987383  -6.0989647  -1.3999106
 Effect_1  -3.9425187   1.4361634  -6.7573991  -1.1276384
 Effect_2  -3.5563565    1.542331  -6.5793254  -.53338771
Placebo_1   .00376427    .0848207   -.1624843   .17001284
Placebo_2  -.00111556   .24378593  -.47893599   .47670487
Placebo_3  -.00301105   .06186534  -.12426712   .11824501
Placebo_4   .00239518   .05058001  -.09674165     .101532

            Switchers
      ATT           1
 Effect_1           1
 Effect_2           1
Placebo_1           1
Placebo_2           1
Placebo_3           1
Placebo_4           1
(21,172 missing values generated)
(4 real changes made)
(1 observation created)
(1 real change made)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(1 real change made, 1 to missing)
(file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/f
> ig_irs_389_16_22_agi_net_rate_irs_0_sample_all_excl2020_eventstudy
> .jpg not found)
file C:/Users/ji252/Documents/GitHub/multnomah-county-tax/results/fi
> g_irs_389_16_22_agi_net_rate_irs_0_sample_all_excl2020_eventstudy.
> jpg written in JPEG format
(1 observation deleted)
agi_net_rate_irs
Placebo replications (100). This may take some time.
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5
..................................................     50
...............................--Break--
r(1);

end of do-file

--Break--
r(1);

. clear

. clear all

. do "C:\Users\ji252\AppData\Local\Temp\STD13228_00000b.tmp"

. 
. ** INSTALLATION 
. * net install github, from("https://haghish.github.io/github/")
. * github install haghish/rcall, stable
. * ssc install ftools
. * ssc install reghdfe
. * ssc install fre 
. * ssc install coefplot
. * ssc install sdid 
. * ssc install estout 
. * ssc install sdid_event
. * ssc install geodist
. 
. ** Preliminaries 
. capture log close 

. clear matrix

. clear all 

. set more off 

. 
. ** Name of project 
. global pr_name "multnomah"

. 
. ** Date of run 
. global date "`: di %tdCY-N-D daily("$S_DATE", "DMY")'"

. 
. ** Set Directories
. global dir "C:/Users/ji252/Documents/GitHub/multnomah-county-tax/"
>       

. global code     "${dir}code/"                           // CODE FI
> LEPATH

. global data     "${dir}data/"                           // DATA FI
> LEPATH

. global results  "${dir}results/"                        // RESULTS
>  FILEPATH

. global logs     "${code}logs/"                          // LOG FIL
> E SUB-FILEPATH

. 
. ** Set WD 
. cd ${dir}
C:\Users\ji252\Documents\GitHub\multnomah-county-tax

. 
. ** OVERLEAF FILE PATH 
. /*
> global oth_path         ///
>         "/Users/johniselin/Library/CloudStorage/Dropbox/Apps/Overl
> eaf/Multnomah County/"        
> */
.         
. ** Start log file 
. log using "${logs}00_log_${pr_name}_${date}", replace text 
(file
    C:/Users/ji252/Documents/GitHub/multnomah-county-tax/code/logs
    > /00_log_multnomah_2026-01-11.log not found)
--------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/ji252/Documents/GitHub/multnomah-county-tax/co
> de/logs/00_log_multnomah_2026-01-11.log
  log type:  text
 opened on:  11 Jan 2026, 13:04:19

. 
. ** Set Seed 
. set seed 56403

. 
. ** Set scheme
. set scheme plotplainblind

. 
. ** Set parameters 
. local overwrite_csv = 0

. global start_year_acs = 2015

. global end_year_acs = 2024

. 
end of do-file

. do "C:\Users\ji252\AppData\Local\Temp\STD13228_00000c.tmp"

. 
. 
. ** Start log file 
. capture log close log_02
